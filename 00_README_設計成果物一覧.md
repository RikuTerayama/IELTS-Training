# MVP設計成果物一覧

このディレクトリには、IELTS Writing/Speaking向けWebアプリのMVP設計成果物が含まれています。

## ドキュメント構成

### 1. 画面設計
- **`01_画面遷移図_UI配置詳細.md`** - 全8画面の詳細なUI配置（ワイヤー）、遷移条件、主要コンポーネント

### 2. データ設計
- **`02_フィードバックJSONスキーマ.md`** - フィードバックJSONのTypeScript型定義とJSON Schema
- **`05_DBテーブル設計_最小構成.md`** - Supabase Postgresのテーブル設計（8テーブル）、RLS方針、主要クエリ

### 3. 型定義
- **`06_TypeScript型定義.md`** - 全TypeScript型定義（Feedback, Task, Attempt, など）

### 4. API設計
- **`07_LLMプロンプトテンプレート.md`** - LLMプロンプトテンプレート（4種類固定）
- **`08_API設計_統一フォーマット.md`** - Next.js Route HandlersのAPI設計、統一レスポンス形式

### 5. タスク例
- **`03_タスク例_初級中級上級.md`** - 初級/中級/上級の実際のタスク例（お題、入力、穴埋め、フィードバック、Band-up actions）

### 6. 実装計画
- **`04_開発タスク分解.md`** - 縦スライス優先の実装タスク分解、週次マイルストーン

---

## 実装時の参照順序

### 最初に確認すべきドキュメント
1. **`01_画面遷移図_UI配置詳細.md`** - UI配置を理解
2. **`05_DBテーブル設計_最小構成.md`** - データベース設計を理解
3. **`06_TypeScript型定義.md`** - 型定義を理解
4. **`04_開発タスク分解.md`** - 実装計画を確認

### 実装中に参照するドキュメント
- **`08_API設計_統一フォーマット.md`** - API実装時
- **`07_LLMプロンプトテンプレート.md`** - LLM呼び出し実装時
- **`02_フィードバックJSONスキーマ.md`** - フィードバック処理実装時
- **`03_タスク例_初級中級上級.md`** - テストデータ作成時

---

## 設計のポイント

### 1. 実装範囲の固定
- **音声録音・文字起こし・Speaking添削はPhase2**（MVPでは実装しない）
- Speaking画面は「テキストの練習プロンプト表示のみ」に限定
- MVPの中心価値は「Writing負荷を下げつつ、Band-up actionsを最大3つに絞って継続させる」

### 2. LLM出力の厳格化
- すべてのLLM出力は**必ずJSONで返す**（`schema_version` を含む）
- JSONでなかった場合はリトライ（最大3回）
- 統一レスポンス形式: `{ ok: boolean, data?: T, error?: {...} }`

### 3. 画面設計の固定
- 共通レイアウト: Header（アプリ名/メニュー/ログイン状態） + Main + Footer（今日の進捗/次のおすすめ）
- 各画面は最小限のUIのみ（増やさない）
- 詳細は `01_画面遷移図_UI配置詳細.md` を参照

### 4. データベース設計の簡素化
- 最小構成8テーブル（profiles, tasks, attempts, feedbacks, revisions, vocab_items, vocab_logs, daily_state）
- RLSは最小ルール（`user_id = auth.uid()` のみ許可）
- 詳細は `05_DBテーブル設計_最小構成.md` を参照

### 5. 縦スライス優先の実装
- 機能を横に広げず、縦スライスを完成させてから次へ進む
- 縦スライス1（Login → Home → Task → Submit → Feedback → Progress）を最優先
- 詳細は `04_開発タスク分解.md` を参照

### 6. 品質ガード
- Band-up actionsは最大3つ（優先順位1, 2, 3）
- 書き直し対象は最大2箇所
- 全文書き換え禁止（指定範囲のみ）
- 具体例（改善前→改善後）を必ず含める

---

## 技術スタック

- **フロントエンド**: Next.js 14+ (App Router) + TypeScript + Tailwind CSS
- **バックエンド**: Next.js Route Handlers + Supabase (Auth, Postgres)
- **LLM**: OpenAI API または Anthropic API
- **デプロイ**: Vercel

---

## 実装開始時のチェックリスト

- [ ] プロジェクトセットアップ（Next.js + TypeScript + Supabase）
- [ ] データベーステーブル作成（`05_DBテーブル設計_最小構成.md` のDDL実行）
- [ ] 共通基盤実装（共通レイアウト、APIレスポンス形式、LLM呼び出し関数）
- [ ] TypeScript型定義実装（`06_TypeScript型定義.md`）
- [ ] 縦スライス1実装開始（認証 → HOME → TASK → フィードバック → PROGRESS）

---

## 注意事項

1. **音声録音機能はPhase2**: MVPでは実装しない
2. **グラフは不要**: PROGRESS画面の弱点推移はテキスト表示のみ
3. **穴埋め問題は最大3問**: ユーザーの負担を最小化
4. **書き直しは最大2箇所**: 全文書き換え禁止
5. **Band-up actionsは最大3つ**: ユーザーを圧倒しない

---

## 質問・不明点

設計で不明な点があれば、以下の順序で確認：
1. 該当するドキュメントを再確認
2. 合理的な仮定を置いて前に進む（仮定は明示）
3. 実装中に必要に応じて設計を調整

すべてのドキュメントは日本語で記述されており、コピペで開発に使える形式です。

